#!/usr/bin/env python
import sys
import lzma, base64
from kutt import kutt
from config import *

try:
    filepath = sys.argv[1]
except:
    print ("> itty [FILEPATH]")
    sys.exit(1)

with open(filepath, 'r') as f:
    content = f.read()
    f.close()

filename = filepath.split("/")[-1].replace(" ", "_").replace("-", "_")

itty_bitty_url = "https://itty.bitty.site/#"+filename+"/"+base64.b64encode(lzma.compress(bytes(content,encoding="utf-8"), format=lzma.FORMAT_ALONE, preset=9)).decode('utf-8')

k = kutt.submit(KUTT_API, itty_bitty_url)

print (k['shortUrl'])